/*
Deployment script for EmployeeDB

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "EmployeeDB"
:setvar DefaultFilePrefix "EmployeeDB"
:setvar DefaultDataPath "C:\Program Files\Microsoft SQL Server\MSSQL16.MSSQLSERVER\MSSQL\DATA\"
:setvar DefaultLogPath "C:\Program Files\Microsoft SQL Server\MSSQL16.MSSQLSERVER\MSSQL\DATA\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
PRINT N'Altering Procedure [dbo].[spResetAndPopulateEmployeeTable]...';


GO
ALTER PROCEDURE spResetAndPopulateEmployeeTable
AS
BEGIN
    IF OBJECT_Id('Employee', 'U') IS NOT NULL
    BEGIN
        -- Employee table exists, purge all data
        DELETE FROM Employee;
    END
    ELSE
    BEGIN
        -- Employee table does not exist, create it
        CREATE TABLE Employee (
            Id INT PRIMARY KEY,
            EmpNo VARCHAR(6) UNIQUE,
            FirstName VARCHAR(15),
            LastName VARCHAR(15),
            Birthdate DATE,
            ContactNo NUMERIC(11),
            EmailAddress VARCHAR(255)
        );
    END

    -- Insert sample data into the Employee table
    INSERT INTO Employee (EmpNo, FirstName, LastName, Birthdate, ContactNo, EmailAddress)
    VALUES
        ('E00001', 'John', 'Doe', '1990-05-15', 12345678901, 'john.doe@example.com'),
        ('E00002', 'Jane', 'Smith', '1995-08-21', 23456789012, 'jane.smith@example.com'),
        ('E00003', 'Michael', 'Johnson', '1988-12-10', 34567890123, 'michael.johnson@example.com'),
        ('E00004', 'Sarah', 'Williams', '1992-03-27', 45678901234, 'sarah.williams@example.com'),
        ('E00005', 'Robert', 'Brown', '1985-09-02', 56789012345, 'robert.brown@example.com'),
        ('E00006', 'Emily', 'Davis', '1998-06-18', 67890123456, 'emily.davis@example.com'),
        ('E00007', 'Daniel', 'Taylor', '1993-11-14', 78901234567, 'daniel.taylor@example.com'),
        ('E00008', 'Olivia', 'Anderson', '1991-02-25', 89012345678, 'olivia.anderson@example.com'),
        ('E00009', 'Matthew', 'Wilson', '1987-07-09', 90123456789, 'matthew.wilson@example.com'),
        ('E00010', 'Sophia', 'Walker', '1994-04-30', 12345678901, 'sophia.walker@example.com');
END
GO
/*
Post-Deployment Script Template							
--------------------------------------------------------------------------------------
 This file contains SQL statements that will be appended to the build script.		
 Use SQLCMD syntax to include a file in the post-deployment script.			
 Example:      :r .\myfile.sql								
 Use SQLCMD syntax to reference a variable in the post-deployment script.		
 Example:      :setvar TableName MyTable							
               SELECT * FROM [$(TableName)]					
--------------------------------------------------------------------------------------
*/
SET ANSI_PADDING ON

EXEC spResetAndPopulateEmployeeTable;

SET ANSI_PADDING OFF
GO

GO
PRINT N'Update complete.';


GO
